# Generate TypeScript Client for IPC

!!! info
    This is an experimental feature. You may also encounter some bugsâ€”please report them on GitHub issues!

---

Since `v0.7`, pytauri natively supports generating a TypeScript client for [Commands][pytauri.Commands]. This makes calling pytauri commands in TypeScript very simple and type-safe.

## Install Dependencies

pytauri uses pydantic to generate jsonschema, then calls [json-schema-to-typescript] to convert it into TypeScript type definitions.

Install the dependencies with the following commands:

```bash
pnpm add json-schema-to-typescript --save-dev

pnpm json2ts --help  # check if installed correctly
```

[json-schema-to-typescript]: https://github.com/bcherny/json-schema-to-typescript

## Usage Example

[Commands.experimental_gen_ts_background][pytauri.ipc.Commands.experimental_gen_ts_background]

```python title="src-tauri/python/__init__.py"
--8<-- "docs_src/tutorial/gen_ts.py"
```

When you run your app (`pnpm tauri dev`), the TypeScript client code will be generated in the `src/client` directory:

!!! tip
    Every time you modify a command, the TypeScript client code will automatically update after hot reload. Awesome ðŸŽ‰!

```ts title="src/client/apiClient.ts"
/* eslint-disable */
/**
 * This file was automatically generated by pytauri-gen-ts.
 * DO NOT MODIFY IT BY HAND. Instead, modify the source commands API,
 * and run pytauri-gen-ts to regenerate this file.
 */

import { pyInvoke } from "tauri-plugin-pytauri-api";
import { InvokeOptions } from "@tauri-apps/api/core";

import type { Commands } from "./_apiTypes.d.ts";

/**
 * A simple command that returns a greeting message.
 *
 * @param body - The person to greet.
 */
export async function greetToPerson(
    body: Commands["greet_to_person"]["input"],
    options?: InvokeOptions
): Promise<Commands["greet_to_person"]["output"]> {
    return await pyInvoke("greet_to_person", body, options);
}
```

## FAQ

### JS `Channel` and PY `JavaScriptChannelId` Type Mismatch

> `Argument of type 'Channel<unknown>' is not assignable to parameter of type 'string'.ts(2345)`

[JavaScriptChannelId][pytauri.ipc.JavaScriptChannelId] is serialized and deserialized as a `string` between the frontend and backend, so the generated ts type is `string`.

You just need to pass `Channel.toJSON()` (i.e., `JSON.stringify(Channel)`):

```ts
import { Channel } from "@tauri-apps/api/core";

const channel = new Channel();
await fooCmd(channel.toJSON()); // pass the channel as a string
```

*This is a known limitation, but we don't know how to solve it yet. If you have a good suggestion, please open a GitHub issue ðŸ˜‡.*

### How to Generate TS Types for `Event` and `Channel`?

*Not supported yet. We haven't figured out an ergonomic API. If you have a good suggestion, please open a GitHub issue ðŸ˜‡.*
